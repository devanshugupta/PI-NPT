2024-04-16 12:08:03,212 INFO    MainThread:35755 [wandb_setup.py:_flush():76] Current SDK version is 0.16.5
2024-04-16 12:08:03,212 INFO    MainThread:35755 [wandb_setup.py:_flush():76] Configure stats pid to 35755
2024-04-16 12:08:03,212 INFO    MainThread:35755 [wandb_setup.py:_flush():76] Loading settings from /Users/devu/.config/wandb/settings
2024-04-16 12:08:03,212 INFO    MainThread:35755 [wandb_setup.py:_flush():76] Loading settings from /Users/devu/PycharmProjects/non-parametric-transformers/wandb/settings
2024-04-16 12:08:03,212 INFO    MainThread:35755 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-04-16 12:08:03,213 INFO    MainThread:35755 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-04-16 12:08:03,213 INFO    MainThread:35755 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'run.py', 'program_abspath': '/Users/devu/PycharmProjects/non-parametric-transformers/run.py', 'program': 'run.py'}
2024-04-16 12:08:03,213 INFO    MainThread:35755 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-04-16 12:08:03,213 INFO    MainThread:35755 [wandb_init.py:_log_setup():527] Logging user logs to ./wandb/run-20240416_120803-sot52mqu/logs/debug.log
2024-04-16 12:08:03,213 INFO    MainThread:35755 [wandb_init.py:_log_setup():528] Logging internal logs to ./wandb/run-20240416_120803-sot52mqu/logs/debug-internal.log
2024-04-16 12:08:03,213 INFO    MainThread:35755 [wandb_init.py:init():567] calling init triggers
2024-04-16 12:08:03,213 INFO    MainThread:35755 [wandb_init.py:init():574] wandb.init called with sweep_config: {}
config: {}
2024-04-16 12:08:03,213 INFO    MainThread:35755 [wandb_init.py:init():617] starting backend
2024-04-16 12:08:03,213 INFO    MainThread:35755 [wandb_init.py:init():621] setting up manager
2024-04-16 12:08:03,215 INFO    MainThread:35755 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=spawn,fork,forkserver, using: spawn
2024-04-16 12:08:03,217 INFO    MainThread:35755 [wandb_init.py:init():629] backend started and connected
2024-04-16 12:08:03,224 INFO    MainThread:35755 [wandb_init.py:init():721] updated telemetry
2024-04-16 12:08:03,253 INFO    MainThread:35755 [wandb_init.py:init():754] communicating run to backend with 90.0 second timeout
2024-04-16 12:08:03,793 INFO    MainThread:35755 [wandb_run.py:_on_init():2344] communicating current version
2024-04-16 12:08:03,938 INFO    MainThread:35755 [wandb_run.py:_on_init():2353] got version response upgrade_message: "wandb version 0.16.6 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-04-16 12:08:03,938 INFO    MainThread:35755 [wandb_init.py:init():805] starting run threads in backend
2024-04-16 12:08:09,157 INFO    MainThread:35755 [wandb_run.py:_console_start():2323] atexit reg
2024-04-16 12:08:09,157 INFO    MainThread:35755 [wandb_run.py:_redirect():2178] redirect: wrap_raw
2024-04-16 12:08:09,158 INFO    MainThread:35755 [wandb_run.py:_redirect():2243] Wrapping output streams.
2024-04-16 12:08:09,158 INFO    MainThread:35755 [wandb_run.py:_redirect():2268] Redirects installed.
2024-04-16 12:08:09,159 INFO    MainThread:35755 [wandb_init.py:init():848] run started, returning control to user process
2024-04-16 12:08:09,160 INFO    MainThread:35755 [wandb_run.py:_config_callback():1347] config_cb None None {'entity': None, 'project': 'default', 'wandb_dir': './', 'data_path': 'data', 'data_set': 'ode', 'data_loader_nprocs': 0, 'data_set_on_cuda': False, 'data_force_reload': False, 'data_log_mem_usage': False, 'data_clear_tmp_files': False, 'data_dtype': 'float32', 'exp_device': 'cpu', 'exp_azure_sweep': False, 'exp_test_equivariance': False, 'exp_show_empirical_label_dist': False, 'exp_smoke_test': False, 'exp_name': 'd18fd8th', 'exp_group': None, 'np_seed': 42, 'torch_seed': 42, 'baseline_seed': 42, 'exp_use_cuda': True, 'exp_n_runs': 1, 'exp_batch_size': -1, 'exp_batch_mode_balancing': True, 'exp_batch_class_balancing': False, 'exp_minibatch_sgd': True, 'exp_val_perc': 0.1, 'exp_test_perc': 0.2, 'exp_num_total_steps': 100000.0, 'exp_patience': -1, 'exp_checkpoint_setting': 'best_model', 'exp_cache_cadence': 1, 'exp_load_from_checkpoint': False, 'exp_print_every_nth_forward': False, 'exp_eval_every_n': 5, 'exp_eval_every_epoch_or_steps': 'epochs', 'exp_eval_test_at_end_only': False, 'exp_artificial_missing': 0, 'exp_optimizer': 'lookahead_lamb', 'exp_lookahead_update_cadence': 6, 'exp_optimizer_warmup_proportion': 0.7, 'exp_optimizer_warmup_fixed_n_steps': 10000, 'exp_lr': 0.001, 'exp_scheduler': 'flat_and_anneal', 'exp_gradient_clipping': 1.0, 'exp_weight_decay': 0, 'exp_tradeoff': 0.5, 'exp_tradeoff_annealing': 'cosine', 'exp_tradeoff_annealing_proportion': 1, 'mp_distributed': False, 'mp_nodes': 1, 'mp_gpus': 1, 'mp_nr': 0, 'mp_no_sync': -1, 'mp_bucket_cap_mb': 25, 'verbose': False, 'debug_leakage': False, 'debug_label_leakage': False, 'debug_row_interactions': False, 'debug_eval_row_interactions': False, 'debug_eval_row_interactions_timer': None, 'debug_row_interactions_mode': None, 'debug_no_stratify': False, 'debug_corrupt_standard_dataset_ablate_shuffle': False, 'model_class': 'NPT', 'sklearn_hyper_search': 'Grid', 'sklearn_model': 'All', 'sklearn_verbose': 1, 'sklearn_n_jobs': -1, 'sklearn_val_final_fit': False, 'model_is_semi_supervised': True, 'model_dtype': 'float32', 'model_amp': False, 'model_feature_type_embedding': True, 'model_feature_index_embedding': True, 'model_bert_augmentation': True, 'model_bert_mask_percentage': 0.9, 'model_augmentation_bert_mask_prob': {'train': 0.15, 'val': 0.0, 'test': 0.0}, 'model_label_bert_mask_prob': {'train': 1, 'val': 1, 'test': 1}, 'model_embedding_layer_norm': False, 'model_att_block_layer_norm': True, 'model_layer_norm_eps': 1e-12, 'model_att_score_norm': 'softmax', 'model_pre_layer_norm': True, 'model_hidden_dropout_prob': 0.1, 'model_att_score_dropout_prob': 0.1, 'model_hybrid_debug': False, 'model_checkpoint_key': None, 'model_dim_hidden': 64, 'model_num_heads': 8, 'model_sep_res_embed': True, 'model_stacking_depth': 8, 'model_mix_heads': True, 'model_rff_depth': 1, 'model_image_n_patches': False, 'model_image_patch_type': 'linear', 'model_image_n_channels': 3, 'model_image_share_embed': True, 'model_image_n_classes': 10, 'model_image_random_crop_and_flip': True, 'metrics_auroc': True, 'viz_att_maps': False, 'viz_att_maps_save_path': 'data/attention_maps', 'cv_index': 0}
2024-04-16 12:08:17,476 WARNING MsgRouterThr:35755 [router.py:message_loop():77] message_loop has been closed
