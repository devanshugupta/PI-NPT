Loaded metadata for fixed test set. n_cv_splits set to 1.
CV Splits for this dataset are cached. Loading from file.
CV Index: 0
Train-test Split 1/1
Building NPT.
All features are either categorical or numerical. Not going to bother doing feature type embeddings.
Using feature type embedding (unique embedding for categorical and numerical features).
Using feature index embedding (unique embedding for each column).
Clipping gradients to value 1.0.
Model has 7907718 parameters,batch size -1.
Initialized "lookahead_lamb" optimizer.
{'_items': {'_wandb': {}, 'entity': None, 'project': 'default', 'wandb_dir': './', 'data_path': 'data', 'data_set': 'ode', 'data_loader_nprocs': 0, 'data_set_on_cuda': False, 'data_force_reload': False, 'data_log_mem_usage': False, 'data_clear_tmp_files': False, 'data_dtype': 'float32', 'exp_device': 'cpu', 'exp_azure_sweep': False, 'exp_test_equivariance': False, 'exp_show_empirical_label_dist': False, 'exp_smoke_test': False, 'exp_name': '3bcxuco4', 'exp_group': None, 'np_seed': 42, 'torch_seed': 42, 'baseline_seed': 42, 'exp_use_cuda': True, 'exp_n_runs': 1, 'exp_batch_size': -1, 'exp_batch_mode_balancing': True, 'exp_batch_class_balancing': False, 'exp_minibatch_sgd': True, 'exp_val_perc': 0.1, 'exp_test_perc': 0.2, 'exp_num_total_steps': 100000.0, 'exp_patience': -1, 'exp_checkpoint_setting': 'best_model', 'exp_cache_cadence': 1, 'exp_load_from_checkpoint': False, 'exp_print_every_nth_forward': False, 'exp_eval_every_n': 5, 'exp_eval_every_epoch_or_steps': 'epochs', 'exp_eval_test_at_end_only': False, 'exp_artificial_missing': 0, 'exp_optimizer': 'lookahead_lamb', 'exp_lookahead_update_cadence': 6, 'exp_optimizer_warmup_proportion': 0.7, 'exp_optimizer_warmup_fixed_n_steps': 10000, 'exp_lr': 0.001, 'exp_scheduler': 'flat_and_anneal', 'exp_gradient_clipping': 1.0, 'exp_weight_decay': 0, 'exp_tradeoff': 0.5, 'exp_tradeoff_annealing': 'cosine', 'exp_tradeoff_annealing_proportion': 1, 'mp_distributed': False, 'mp_nodes': 1, 'mp_gpus': 1, 'mp_nr': 0, 'mp_no_sync': -1, 'mp_bucket_cap_mb': 25, 'verbose': False, 'debug_leakage': False, 'debug_label_leakage': False, 'debug_row_interactions': False, 'debug_eval_row_interactions': False, 'debug_eval_row_interactions_timer': None, 'debug_row_interactions_mode': None, 'debug_no_stratify': False, 'debug_corrupt_standard_dataset_ablate_shuffle': False, 'model_class': 'NPT', 'sklearn_hyper_search': 'Grid', 'sklearn_model': 'All', 'sklearn_verbose': 1, 'sklearn_n_jobs': -1, 'sklearn_val_final_fit': False, 'model_is_semi_supervised': True, 'model_dtype': 'float32', 'model_amp': False, 'model_feature_type_embedding': True, 'model_feature_index_embedding': True, 'model_bert_augmentation': True, 'model_bert_mask_percentage': 0.9, 'model_augmentation_bert_mask_prob': {'train': 0.15, 'val': 0.0, 'test': 0.0}, 'model_label_bert_mask_prob': {'train': 1, 'val': 1, 'test': 1}, 'model_embedding_layer_norm': False, 'model_att_block_layer_norm': True, 'model_layer_norm_eps': 1e-12, 'model_att_score_norm': 'softmax', 'model_pre_layer_norm': True, 'model_hidden_dropout_prob': 0.1, 'model_att_score_dropout_prob': 0.1, 'model_hybrid_debug': False, 'model_checkpoint_key': None, 'model_dim_hidden': 64, 'model_num_heads': 8, 'model_sep_res_embed': True, 'model_stacking_depth': 8, 'model_mix_heads': True, 'model_rff_depth': 1, 'model_image_n_patches': False, 'model_image_patch_type': 'linear', 'model_image_n_channels': 3, 'model_image_share_embed': True, 'model_image_n_classes': 10, 'model_image_random_crop_and_flip': True, 'metrics_auroc': True, 'viz_att_maps': False, 'viz_att_maps_save_path': 'data/attention_maps', 'cv_index': 0}, '_locked': {}, '_users': {}, '_users_inv': {}, '_users_cnt': 0, '_callback': <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x3086adf70>>, '_settings': <Settings {'_Settings__frozen': False, '_Settings__initialized': True, '_Settings__modification_order': ('_async_upload_concurrency_limit', '_service_wait', '_stats_sample_rate_seconds', '_stats_samples_to_average', 'anonymous', 'api_key', 'base_url', 'console', 'job_source', 'mode', 'problem', 'project', 'run_id', 'start_method', '_aws_lambda', 'program', '_code_path_local', '_colab', '_disable_machine_info', '_disable_meta', '_disable_stats', '_network_buffer', '_flow_control_disabled', '_flow_control_custom', '_ipython', '_jupyter', '_kaggle', '_noop', '_notebook', 'disabled', '_offline', '_shared', '_stats_neuron_monitor_config_path', 'run_mode', '_start_datetime', 'timespec', 'root_dir', 'wandb_dir', 'tmp_dir', '_tmp_code_dir', '_windows', 'colab_url', 'is_local', 'deployment', 'disable_code', 'disable_git', 'disable_job_creation', 'files_dir', 'log_dir', 'log_internal', 'log_symlink_internal', 'log_symlink_user', 'log_user', 'project_url', 'resume_fname', 'run_url', 'settings_system', 'settings_workspace', 'sweep_url', 'sync_dir', 'sync_file', 'sync_symlink_latest'), '_Settings_start_datetime': '20240417_140751', '_Settings_start_time': 1713388071.450133, '_args': "<Property value=['--data_set', 'ode'] source=8>", '_aws_lambda': '<Property value=False source=1>', '_async_upload_concurrency_limit': '<Property value=None source=1>', '_cli_only_mode': '<Property value=None source=1>', '_code_path_local': '<Property value=run.py source=1>', '_colab': '<Property value=False source=1>', '_cuda': '<Property value=None source=1>', '_disable_meta': '<Property value=False source=1>', '_disable_service': '<Property value=False source=9>', '_disable_setproctitle': '<Property value=False source=1>', '_disable_stats': '<Property value=False source=1>', '_disable_viewer': '<Property value=None source=1>', '_disable_machine_info': '<Property value=False source=1>', '_except_exit': '<Property value=None source=1>', '_executable': '<Property value=/Users/devu/anaconda3/envs/npt/bin/python source=8>', '_extra_http_headers': '<Property value=None source=1>', '_file_stream_retry_max': '<Property value=125 source=1>', '_file_stream_retry_wait_min_seconds': '<Property value=2.0 source=1>', '_file_stream_retry_wait_max_seconds': '<Property value=60.0 source=1>', '_file_stream_timeout_seconds': '<Property value=180.0 source=1>', '_file_transfer_retry_max': '<Property value=20 source=1>', '_file_transfer_retry_wait_min_seconds': '<Property value=2.0 source=1>', '_file_transfer_retry_wait_max_seconds': '<Property value=60.0 source=1>', '_file_transfer_timeout_seconds': '<Property value=0.0 source=1>', '_flow_control_custom': '<Property value=False source=1>', '_flow_control_disabled': '<Property value=False source=1>', '_graphql_retry_max': '<Property value=20 source=1>', '_graphql_retry_wait_min_seconds': '<Property value=2.0 source=1>', '_graphql_retry_wait_max_seconds': '<Property value=60.0 source=1>', '_graphql_timeout_seconds': '<Property value=30.0 source=1>', '_internal_check_process': '<Property value=8.0 source=1>', '_internal_queue_timeout': '<Property value=2.0 source=1>', '_ipython': '<Property value=False source=1>', '_jupyter': '<Property value=False source=1>', '_jupyter_name': '<Property value=None source=1>', '_jupyter_path': '<Property value=None source=1>', '_jupyter_root': '<Property value=None source=1>', '_kaggle': '<Property value=False source=1>', '_live_policy_rate_limit': '<Property value=None source=1>', '_live_policy_wait_time': '<Property value=None source=1>', '_log_level': '<Property value=10 source=1>', '_network_buffer': '<Property value=None source=1>', '_noop': '<Property value=False source=1>', '_notebook': '<Property value=False source=1>', '_offline': '<Property value=False source=1>', '_sync': '<Property value=False source=1>', '_os': '<Property value=macOS-14.4.1-arm64-arm-64bit source=8>', '_platform': '<Property value=darwin source=1>', '_proxies': '<Property value=None source=1>', '_python': '<Property value=3.8.19 source=8>', '_runqueue_item_id': '<Property value=None source=1>', '_require_core': '<Property value=False source=1>', '_save_requirements': '<Property value=True source=1>', '_service_transport': '<Property value=None source=1>', '_service_wait': '<Property value=30.0 source=1>', '_shared': '<Property value=False source=1>', '_start_datetime': '<Property value=20240417_140751 source=11>', '_start_time': '<Property value=1713388071.450133 source=11>', '_stats_pid': '<Property value=20534 source=9>', '_stats_sample_rate_seconds': '<Property value=2.0 source=1>', '_stats_samples_to_average': '<Property value=15 source=1>', '_stats_join_assets': '<Property value=True source=1>', '_stats_neuron_monitor_config_path': '<Property value=None source=1>', '_stats_open_metrics_endpoints': '<Property value=None source=1>', '_stats_open_metrics_filters': "<Property value=('.*',) source=1>", '_stats_disk_paths': "<Property value=('/',) source=1>", '_stats_buffer_size': '<Property value=0 source=1>', '_tmp_code_dir': '<Property value=./wandb/run-20240417_140751-3alt979e/tmp/code source=1>', '_tracelog': '<Property value=None source=1>', '_unsaved_keys': '<Property value=None source=1>', '_windows': '<Property value=False source=1>', 'allow_val_change': '<Property value=None source=1>', 'anonymous': '<Property value=None source=1>', 'api_key': '<Property value=None source=1>', 'azure_account_url_to_access_key': '<Property value=None source=1>', 'base_url': '<Property value=https://api.wandb.ai source=1>', 'code_dir': '<Property value=None source=1>', 'colab_url': '<Property value=None source=1>', 'config_paths': '<Property value=None source=1>', 'console': '<Property value=wrap source=1>', 'deployment': '<Property value=cloud source=1>', 'disable_code': '<Property value=False source=1>', 'disable_git': '<Property value=False source=8>', 'disable_hints': '<Property value=None source=1>', 'disable_job_creation': '<Property value=False source=1>', 'disabled': '<Property value=False source=1>', 'docker': '<Property value=None source=8>', 'email': '<Property value=dgupta77@asu.edu source=5>', 'entity': '<Property value=non-param-transformers source=14>', 'files_dir': '<Property value=./wandb/run-20240417_140751-3alt979e/files source=1>', 'force': '<Property value=None source=1>', 'fork_from': '<Property value=None source=1>', 'git_commit': '<Property value=a399360c4ac953eac3149692918df12fafee66e0 source=14>', 'git_remote': '<Property value=origin source=1>', 'git_remote_url': '<Property value=https://github.com/OATML/non-parametric-transformers.git source=14>', 'git_root': '<Property value=None source=1>', 'heartbeat_seconds': '<Property value=30 source=1>', 'host': '<Property value=devanshus-air.3521.dhcp.asu.edu source=14>', 'ignore_globs': '<Property value=() source=1>', 'init_timeout': '<Property value=90.0 source=1>', 'is_local': '<Property value=False source=1>', 'job_name': '<Property value=None source=1>', 'job_source': '<Property value=None source=1>', 'label_disable': '<Property value=None source=1>', 'launch': '<Property value=None source=1>', 'launch_config_path': '<Property value=None source=1>', 'log_dir': '<Property value=./wandb/run-20240417_140751-3alt979e/logs source=1>', 'log_internal': '<Property value=./wandb/run-20240417_140751-3alt979e/logs/debug-internal.log source=1>', 'log_symlink_internal': '<Property value=./wandb/debug-internal.log source=1>', 'log_symlink_user': '<Property value=./wandb/debug.log source=1>', 'log_user': '<Property value=./wandb/run-20240417_140751-3alt979e/logs/debug.log source=1>', 'login_timeout': '<Property value=None source=1>', 'mode': '<Property value=online source=1>', 'notebook_name': '<Property value=None source=1>', 'problem': '<Property value=fatal source=1>', 'program': '<Property value=run.py source=8>', 'program_abspath': '<Property value=/Users/devu/PycharmProjects/non-parametric-transformers/run.py source=8>', 'program_relpath': '<Property value=run.py source=8>', 'project': '<Property value=default source=14>', 'project_url': '<Property value=https://wandb.ai/non-param-transformers/default source=1>', 'quiet': '<Property value=None source=1>', 'reinit': '<Property value=True source=11>', 'relogin': '<Property value=None source=1>', 'resume': '<Property value=None source=1>', 'resume_fname': '<Property value=./wandb/wandb-resume.json source=1>', 'resumed': '<Property value=False source=1>', 'root_dir': '<Property value=./ source=11>', 'run_group': '<Property value=None source=1>', 'run_id': '<Property value=3alt979e source=14>', 'run_job_type': '<Property value=None source=1>', 'run_mode': '<Property value=run source=1>', 'run_name': '<Property value=3bcxuco4 source=14>', 'run_notes': '<Property value=None source=1>', 'run_tags': '<Property value=None source=1>', 'run_url': '<Property value=https://wandb.ai/non-param-transformers/default/runs/3alt979e source=1>', 'sagemaker_disable': '<Property value=None source=1>', 'save_code': '<Property value=None source=1>', 'settings_system': '<Property value=/Users/devu/.config/wandb/settings source=1>', 'settings_workspace': '<Property value=./wandb/settings source=1>', 'show_colors': '<Property value=None source=1>', 'show_emoji': '<Property value=None source=1>', 'show_errors': '<Property value=True source=1>', 'show_info': '<Property value=True source=1>', 'show_warnings': '<Property value=True source=1>', 'silent': '<Property value=False source=1>', 'start_method': '<Property value=None source=1>', 'strict': '<Property value=None source=1>', 'summary_errors': '<Property value=None source=1>', 'summary_timeout': '<Property value=60 source=1>', 'summary_warnings': '<Property value=5 source=14>', 'sweep_id': '<Property value=None source=1>', 'sweep_param_path': '<Property value=None source=1>', 'sweep_url': '<Property value= source=1>', 'symlink': '<Property value=True source=8>', 'sync_dir': '<Property value=./wandb/run-20240417_140751-3alt979e source=1>', 'sync_file': '<Property value=./wandb/run-20240417_140751-3alt979e/run-3alt979e.wandb source=1>', 'sync_symlink_latest': '<Property value=./wandb/latest-run source=1>', 'system_sample': '<Property value=15 source=1>', 'system_sample_seconds': '<Property value=2 source=1>', 'table_raise_on_max_row_limit_exceeded': '<Property value=False source=1>', 'timespec': '<Property value=20240417_140751 source=1>', 'tmp_dir': '<Property value=./wandb/run-20240417_140751-3alt979e/tmp source=1>', 'username': '<Property value=devu source=8>', 'wandb_dir': '<Property value=./wandb/ source=1>'}>, '_artifact_callback': <bound method Run._config_artifact_callback of <wandb.sdk.wandb_run.Run object at 0x3086adf70>>}