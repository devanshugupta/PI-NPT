/Users/devu/anaconda3/envs/npt/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:143: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/Users/devu/PycharmProjects/non-parametric-transformers/npt/mask.py:108: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at /Users/runner/work/_temp/anaconda/conda-bld/pytorch_1711403207619/work/torch/csrc/utils/tensor_new.cpp:620.)
  mask = torch.sparse.FloatTensor(
Loaded metadata for fixed test set. n_cv_splits set to 1.
CV Splits for this dataset are cached. Loading from file.
CV Index: 0
Train-test Split 1/1
Building NPT.
All features are either categorical or numerical. Not going to bother doing feature type embeddings.
Using feature type embedding (unique embedding for categorical and numerical features).
Using feature index embedding (unique embedding for each column).
Clipping gradients to value 1.0.
Model has 31576838 parameters,batch size -1.
Initialized "lookahead_lamb" optimizer.
Warming up for 70000.0/100000.0 steps.
Initialized "flat_and_anneal" learning rate scheduler.
Initialized "cosine" augmentation/label tradeoff annealer. Annealing to minimum value in 100000 steps.
Disabled AUROC in loss module.
end_experiment or self.eval_check(epoch) False False
Computing PINNs Loss:
masked tensor u:  ========> tensor([[0., 1.],
        [0., 1.],
        [0., 1.],
        ...,
        [0., 1.],
        [0., 1.],
        [0., 1.]], requires_grad=True)
{'train_mask_matrix': tensor([[0., 0., 0., 0., 0., 0.],
        [0., 0., 1., 0., 0., 0.],
        [0., 0., 1., 0., 0., 0.],
        ...,
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.]], requires_grad=True), 'cat_features': [], 'num_features': [0, 1, 2, 3, 4, 5], 'data_arrs': [tensor([[ 0.2597,  0.0000],
        [ 0.9760,  0.0000],
        [-1.6595,  0.0000],
        ...,
        [-1.1189,  0.0000],
        [-0.0106,  0.0000],
        [ 1.4626,  0.0000]], requires_grad=True), tensor([[ 1.8207,  0.0000],
        [-1.2226,  0.0000],
        [-1.2226,  0.0000],
        ...,
        [-1.0689,  0.0000],
        [-1.0074,  0.0000],
        [-0.3004,  0.0000]], requires_grad=True), tensor([[ 0.0000,  1.0000],
        [-1.4049,  0.0000],
        [ 0.1436,  0.0000],
        ...,
        [ 0.0000,  1.0000],
        [ 0.0000,  1.0000],
        [ 0.0000,  1.0000]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True)], 'masked_tensors': [tensor([[ 0.2597,  0.0000],
        [ 0.9760,  0.0000],
        [-1.6595,  0.0000],
        ...,
        [-1.1189,  0.0000],
        [-0.0106,  0.0000],
        [ 1.4626,  0.0000]], requires_grad=True), tensor([[ 1.8207,  0.0000],
        [-1.2226,  0.0000],
        [-1.2226,  0.0000],
        ...,
        [-1.0689,  0.0000],
        [-1.0074,  0.0000],
        [-0.3004,  0.0000]], requires_grad=True), tensor([[0., 1.],
        [0., 1.],
        [0., 1.],
        ...,
        [0., 1.],
        [0., 1.],
        [0., 1.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[0., 1.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 1.],
        [0., 0.]], requires_grad=True), tensor([[0., 1.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True)], 'target_cols': [2], 'sigmas': [1.8159747047679642, 0.32858701076537306, 0.7124006452866083, 1.0, 1.0, 1.0], 'label_mask_matrix': None, 'augmentation_mask_matrix': tensor([[0., 0., 0., 0., 1., 1.],
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        ...,
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 1., 0.],
        [0., 0., 0., 0., 0., 0.]], requires_grad=True)}
Gradients shape ------- torch.Size([1256, 2]) torch.Size([1256, 2])
Physics Loss:  tensor(0.0009, grad_fn=<MeanBackward0>)
MSE Loss:   tensor([225.2520], grad_fn=<AddBackward0>)
Done -------------------------epoch  1
end_experiment or self.eval_check(epoch) False False
Computing PINNs Loss:
masked tensor u:  ========> tensor([[0., 1.],
        [0., 1.],
        [0., 1.],
        ...,
        [0., 1.],
        [0., 1.],
        [0., 1.]], requires_grad=True)
{'train_mask_matrix': tensor([[0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 1., 0., 0., 0.],
        ...,
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.]], requires_grad=True), 'cat_features': [], 'num_features': [0, 1, 2, 3, 4, 5], 'data_arrs': [tensor([[ 0.2056,  0.0000],
        [ 0.9760,  0.0000],
        [-0.6864,  0.0000],
        ...,
        [-1.3351,  0.0000],
        [-1.7136,  0.0000],
        [-1.6054,  0.0000]], requires_grad=True), tensor([[-0.5771,  0.0000],
        [-0.8537,  0.0000],
        [-1.2226,  0.0000],
        ...,
        [-0.1467,  0.0000],
        [ 0.0685,  0.0000],
        [ 1.7285,  0.0000]], requires_grad=True), tensor([[0.0000, 1.0000],
        [0.0000, 1.0000],
        [1.3046, 0.0000],
        ...,
        [0.0000, 1.0000],
        [0.0000, 1.0000],
        [0.0000, 1.0000]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True)], 'masked_tensors': [tensor([[ 0.2056,  0.0000],
        [ 0.0000,  1.0000],
        [-0.6864,  0.0000],
        ...,
        [-1.3351,  0.0000],
        [-1.7136,  0.0000],
        [-1.6054,  0.0000]], requires_grad=True), tensor([[-0.5771,  0.0000],
        [-0.8537,  0.0000],
        [-1.2226,  0.0000],
        ...,
        [-0.1467,  0.0000],
        [ 0.0685,  0.0000],
        [ 1.7285,  0.0000]], requires_grad=True), tensor([[0., 1.],
        [0., 1.],
        [0., 1.],
        ...,
        [0., 1.],
        [0., 1.],
        [0., 1.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[0., 1.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 1.],
        [0., 1.]], requires_grad=True), tensor([[0., 1.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 1.],
        [0., 0.],
        [0., 0.]], requires_grad=True)], 'target_cols': [2], 'sigmas': [1.8159747047679642, 0.32858701076537306, 0.7124006452866083, 1.0, 1.0, 1.0], 'label_mask_matrix': None, 'augmentation_mask_matrix': tensor([[0., 0., 0., 0., 1., 1.],
        [1., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        ...,
        [0., 0., 0., 0., 0., 1.],
        [0., 0., 0., 0., 1., 0.],
        [0., 0., 0., 0., 1., 0.]], requires_grad=True)}
Gradients shape ------- torch.Size([1256, 2]) torch.Size([1256, 2])
Physics Loss:  tensor(0.0009, grad_fn=<MeanBackward0>)
MSE Loss:   tensor([235.4550], grad_fn=<AddBackward0>)
Done -------------------------epoch  2
end_experiment or self.eval_check(epoch) False False
Computing PINNs Loss:
masked tensor u:  ========> tensor([[0., 1.],
        [0., 1.],
        [0., 1.],
        ...,
        [0., 1.],
        [0., 1.],
        [0., 1.]], requires_grad=True)
{'train_mask_matrix': tensor([[0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        ...,
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.]], requires_grad=True), 'cat_features': [], 'num_features': [0, 1, 2, 3, 4, 5], 'data_arrs': [tensor([[ 0.4489,  0.0000],
        [ 1.7194,  0.0000],
        [-1.0378,  0.0000],
        ...,
        [ 1.3815,  0.0000],
        [ 1.3274,  0.0000],
        [ 1.2058,  0.0000]], requires_grad=True), tensor([[ 0.0685,  0.0000],
        [-0.1774,  0.0000],
        [ 1.1137,  0.0000],
        ...,
        [ 1.6977,  0.0000],
        [ 0.8370,  0.0000],
        [ 0.3451,  0.0000]], requires_grad=True), tensor([[ 0.0000,  1.0000],
        [-0.0627,  0.0000],
        [ 0.0000,  1.0000],
        ...,
        [ 0.0000,  1.0000],
        [ 0.0000,  1.0000],
        [ 0.0000,  1.0000]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True)], 'masked_tensors': [tensor([[0.4489, 0.0000],
        [1.7194, 0.0000],
        [0.0000, 1.0000],
        ...,
        [1.3815, 0.0000],
        [1.3274, 0.0000],
        [1.2058, 0.0000]], requires_grad=True), tensor([[ 0.0685,  0.0000],
        [-0.1774,  0.0000],
        [ 1.1137,  0.0000],
        ...,
        [ 1.6977,  0.0000],
        [ 0.8370,  0.0000],
        [ 0.0000,  1.0000]], requires_grad=True), tensor([[0., 1.],
        [0., 1.],
        [0., 1.],
        ...,
        [0., 1.],
        [0., 1.],
        [0., 1.]], requires_grad=True), tensor([[0., 1.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 1.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 1.],
        [0., 0.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 1.],
        ...,
        [0., 0.],
        [0., 1.],
        [0., 0.]], requires_grad=True)], 'target_cols': [2], 'sigmas': [1.8159747047679642, 0.32858701076537306, 0.7124006452866083, 1.0, 1.0, 1.0], 'label_mask_matrix': None, 'augmentation_mask_matrix': tensor([[0., 0., 0., 1., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        [1., 0., 0., 0., 0., 1.],
        ...,
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 1., 1.],
        [0., 1., 0., 1., 0., 0.]], requires_grad=True)}
Gradients shape ------- torch.Size([1256, 2]) torch.Size([1256, 2])
Physics Loss:  tensor(0.0014, grad_fn=<MeanBackward0>)
MSE Loss:   tensor([221.8563], grad_fn=<AddBackward0>)
Done -------------------------epoch  3
end_experiment or self.eval_check(epoch) False False
Computing PINNs Loss:
masked tensor u:  ========> tensor([[0., 1.],
        [0., 1.],
        [0., 1.],
        ...,
        [0., 1.],
        [0., 1.],
        [0., 1.]], requires_grad=True)
{'train_mask_matrix': tensor([[0., 0., 0., 0., 0., 0.],
        [0., 0., 1., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        ...,
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.]], requires_grad=True), 'cat_features': [], 'num_features': [0, 1, 2, 3, 4, 5], 'data_arrs': [tensor([[ 0.1110,  0.0000],
        [ 0.2597,  0.0000],
        [-1.5649,  0.0000],
        ...,
        [-1.4027,  0.0000],
        [ 1.0571,  0.0000],
        [ 0.4219,  0.0000]], requires_grad=True), tensor([[-0.7308,  0.0000],
        [-1.2226,  0.0000],
        [ 0.0685,  0.0000],
        ...,
        [ 0.9600,  0.0000],
        [-1.2226,  0.0000],
        [ 0.9907,  0.0000]], requires_grad=True), tensor([[ 0.0000,  1.0000],
        [-0.6593,  0.0000],
        [ 0.0000,  1.0000],
        ...,
        [ 0.0000,  1.0000],
        [-1.3499,  0.0000],
        [ 0.0000,  1.0000]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True)], 'masked_tensors': [tensor([[ 0.1110,  0.0000],
        [ 0.2597,  0.0000],
        [-1.5649,  0.0000],
        ...,
        [-1.4027,  0.0000],
        [ 1.0571,  0.0000],
        [ 0.4219,  0.0000]], requires_grad=True), tensor([[-0.7308,  0.0000],
        [-1.2226,  0.0000],
        [ 0.0685,  0.0000],
        ...,
        [ 0.9600,  0.0000],
        [ 0.0000,  1.0000],
        [ 0.9907,  0.0000]], requires_grad=True), tensor([[0., 1.],
        [0., 1.],
        [0., 1.],
        ...,
        [0., 1.],
        [0., 1.],
        [0., 1.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 1.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 1.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 1.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True)], 'target_cols': [2], 'sigmas': [1.8159747047679642, 0.32858701076537306, 0.7124006452866083, 1.0, 1.0, 1.0], 'label_mask_matrix': None, 'augmentation_mask_matrix': tensor([[0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 1., 0.],
        ...,
        [0., 0., 0., 0., 0., 0.],
        [0., 1., 0., 0., 0., 0.],
        [0., 0., 0., 1., 1., 0.]], requires_grad=True)}
Gradients shape ------- torch.Size([1256, 2]) torch.Size([1256, 2])
Physics Loss:  tensor(0.0023, grad_fn=<MeanBackward0>)
MSE Loss:   tensor([221.2189], grad_fn=<AddBackward0>)
Done -------------------------epoch  4
end_experiment or self.eval_check(epoch) False True
Computing PINNs Loss:
masked tensor u:  ========> tensor([[0., 1.],
        [0., 1.],
        [0., 1.],
        ...,
        [0., 1.],
        [0., 1.],
        [0., 1.]], requires_grad=True)
{'train_mask_matrix': tensor([[0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        ...,
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.]], requires_grad=True), 'cat_features': [], 'num_features': [0, 1, 2, 3, 4, 5], 'data_arrs': [tensor([[ 0.3678,  0.0000],
        [-1.2675,  0.0000],
        [ 0.6787,  0.0000],
        ...,
        [-0.9702,  0.0000],
        [ 0.2056,  0.0000],
        [-0.9432,  0.0000]], requires_grad=True), tensor([[0.4989, 0.0000],
        [0.1607, 0.0000],
        [0.3759, 0.0000],
        ...,
        [1.0214, 0.0000],
        [0.8063, 0.0000],
        [0.4374, 0.0000]], requires_grad=True), tensor([[0., 1.],
        [0., 1.],
        [0., 1.],
        ...,
        [0., 1.],
        [0., 1.],
        [0., 1.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True)], 'masked_tensors': [tensor([[ 0.3678,  0.0000],
        [-1.2675,  0.0000],
        [ 0.6787,  0.0000],
        ...,
        [ 0.0000,  1.0000],
        [ 0.2056,  0.0000],
        [-0.9432,  0.0000]], requires_grad=True), tensor([[0.4989, 0.0000],
        [0.1607, 0.0000],
        [0.3759, 0.0000],
        ...,
        [1.0214, 0.0000],
        [0.8063, 0.0000],
        [0.0000, 1.0000]], requires_grad=True), tensor([[0., 1.],
        [0., 1.],
        [0., 1.],
        ...,
        [0., 1.],
        [0., 1.],
        [0., 1.]], requires_grad=True), tensor([[0., 1.],
        [0., 0.],
        [0., 1.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[ 0.0000,  0.0000],
        [ 0.0000,  1.0000],
        [ 0.0000,  0.0000],
        ...,
        [ 0.8690,  0.0000],
        [-0.0245,  0.0000],
        [ 0.0000,  0.0000]], requires_grad=True), tensor([[0., 1.],
        [0., 0.],
        [0., 1.],
        ...,
        [0., 0.],
        [0., 1.],
        [0., 0.]], requires_grad=True)], 'target_cols': [2], 'sigmas': [1.8159747047679642, 0.32858701076537306, 0.7124006452866083, 1.0, 1.0, 1.0], 'label_mask_matrix': None, 'augmentation_mask_matrix': tensor([[0., 0., 0., 1., 0., 1.],
        [0., 0., 0., 0., 1., 0.],
        [0., 0., 0., 1., 0., 1.],
        ...,
        [1., 0., 0., 0., 1., 0.],
        [0., 0., 0., 0., 1., 1.],
        [0., 1., 0., 0., 0., 0.]], requires_grad=True)}
Gradients shape ------- torch.Size([1256, 2]) torch.Size([1256, 2])
Physics Loss:  tensor(0.0029, grad_fn=<MeanBackward0>)
MSE Loss:   tensor([205.9413], grad_fn=<AddBackward0>)
Done -------------------------epoch  5
Traceback (most recent call last):
  File "run.py", line 204, in <module>
    main(args)
  File "run.py", line 23, in main
    run_cv(args=args, wandb_args=wandb_args)
  File "run.py", line 117, in run_cv
    run_cv_splits(wandb_args, args, c, wandb_run)
  File "run.py", line 195, in run_cv_splits
    trainer.train_and_eval()
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/train.py", line 216, in train_and_eval
    if self.per_epoch_train_eval(epoch=epoch):
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/train.py", line 175, in per_epoch_train_eval
    early_stop = self.eval_model(
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/train.py", line 224, in eval_model
    val_loss = self.run_epoch(dataset_mode='val', **kwargs)
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/train.py", line 437, in run_epoch
    self.run_batch(
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/train.py", line 546, in run_batch
    self.forward_and_loss(**forward_kwargs)
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/train.py", line 613, in forward_and_loss
    self.loss.compute(**loss_kwargs)
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/loss.py", line 96, in compute
    loss_dict = self.compute_loss(*args, **kwargs)
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/loss.py", line 321, in compute_loss
    physics_loss = self.convection_diffusion_loss(output, data_dict, masked_tensors)
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/loss.py", line 151, in convection_diffusion_loss
    u_t = torch.autograd.grad(u.sum(), t, create_graph=True)[0]
  File "/Users/devu/anaconda3/envs/npt/lib/python3.8/site-packages/torch/autograd/__init__.py", line 411, in grad
    result = Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: One of the differentiated Tensors appears to not have been used in the graph. Set allow_unused=True if this is the desired behavior.
Traceback (most recent call last):
  File "run.py", line 204, in <module>
    main(args)
  File "run.py", line 23, in main
    run_cv(args=args, wandb_args=wandb_args)
  File "run.py", line 117, in run_cv
    run_cv_splits(wandb_args, args, c, wandb_run)
  File "run.py", line 195, in run_cv_splits
    trainer.train_and_eval()
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/train.py", line 216, in train_and_eval
    if self.per_epoch_train_eval(epoch=epoch):
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/train.py", line 175, in per_epoch_train_eval
    early_stop = self.eval_model(
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/train.py", line 224, in eval_model
    val_loss = self.run_epoch(dataset_mode='val', **kwargs)
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/train.py", line 437, in run_epoch
    self.run_batch(
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/train.py", line 546, in run_batch
    self.forward_and_loss(**forward_kwargs)
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/train.py", line 613, in forward_and_loss
    self.loss.compute(**loss_kwargs)
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/loss.py", line 96, in compute
    loss_dict = self.compute_loss(*args, **kwargs)
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/loss.py", line 321, in compute_loss
    physics_loss = self.convection_diffusion_loss(output, data_dict, masked_tensors)
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/loss.py", line 151, in convection_diffusion_loss
    u_t = torch.autograd.grad(u.sum(), t, create_graph=True)[0]
  File "/Users/devu/anaconda3/envs/npt/lib/python3.8/site-packages/torch/autograd/__init__.py", line 411, in grad
    result = Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: One of the differentiated Tensors appears to not have been used in the graph. Set allow_unused=True if this is the desired behavior.
Using torch no grad, eval model= True
Dataset mode -----  val
Computing PINNs Loss:
masked tensor u:  ========> tensor([[0., 1.],
        [0., 1.],
        [0., 1.],
        ...,
        [0., 1.],
        [0., 1.],
        [0., 1.]], requires_grad=True)
{'val_mask_matrix': tensor([[0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        ...,
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0.]], requires_grad=True), 'cat_features': [], 'num_features': [0, 1, 2, 3, 4, 5], 'data_arrs': [tensor([[-1.5919,  0.0000],
        [-0.6323,  0.0000],
        [-1.5784,  0.0000],
        ...,
        [-1.4432,  0.0000],
        [-0.9297,  0.0000],
        [ 1.1652,  0.0000]], requires_grad=True), tensor([[ 0.0377,  0.0000],
        [-1.2226,  0.0000],
        [ 1.1751,  0.0000],
        ...,
        [ 1.7592,  0.0000],
        [ 1.4826,  0.0000],
        [-0.7615,  0.0000]], requires_grad=True), tensor([[0.0000, 1.0000],
        [1.2551, 0.0000],
        [0.0000, 1.0000],
        ...,
        [0.0000, 1.0000],
        [0.0000, 1.0000],
        [0.0000, 1.0000]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True)], 'masked_tensors': [tensor([[-1.5919,  0.0000],
        [-0.6323,  0.0000],
        [-1.5784,  0.0000],
        ...,
        [-1.4432,  0.0000],
        [-0.9297,  0.0000],
        [ 1.1652,  0.0000]], requires_grad=True), tensor([[ 0.0377,  0.0000],
        [-1.2226,  0.0000],
        [ 1.1751,  0.0000],
        ...,
        [ 1.7592,  0.0000],
        [ 1.4826,  0.0000],
        [-0.7615,  0.0000]], requires_grad=True), tensor([[0., 1.],
        [0., 1.],
        [0., 1.],
        ...,
        [0., 1.],
        [0., 1.],
        [0., 1.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True), tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        ...,
        [0., 0.],
        [0., 0.],
        [0., 0.]], requires_grad=True)], 'target_cols': [2], 'sigmas': [1.8159747047679642, 0.32858701076537306, 0.7124006452866083, 1.0, 1.0, 1.0], 'label_mask_matrix': None, 'augmentation_mask_matrix': None}