yoooo--------------------
Shape of boundary points tensor: torch.Size([11, 6])
Shape of collocation points tensor: torch.Size([989, 6])
Disabling AUROC metric.
	Because dataset has 0 =/= 1 categorical target columns.
yoo data dict {'fixed_test_set_index': 256, 'c': {'entity': None, 'project': 'default', 'wandb_dir': './', 'data_path': 'data', 'data_set': 'ode', 'data_loader_nprocs': 0, 'data_set_on_cuda': False, 'data_force_reload': False, 'data_log_mem_usage': False, 'data_clear_tmp_files': False, 'data_dtype': 'float32', 'exp_device': 'cpu', 'exp_azure_sweep': False, 'exp_test_equivariance': False, 'exp_show_empirical_label_dist': False, 'exp_smoke_test': False, 'exp_name': 'bq4x5wis', 'exp_group': None, 'np_seed': 42, 'torch_seed': 42, 'baseline_seed': 42, 'exp_use_cuda': True, 'exp_n_runs': 1, 'exp_batch_size': -1, 'exp_batch_mode_balancing': True, 'exp_batch_class_balancing': False, 'exp_minibatch_sgd': True, 'exp_val_perc': 0.1, 'exp_test_perc': 0.2, 'exp_num_total_steps': 100000.0, 'exp_patience': -1, 'exp_checkpoint_setting': 'best_model', 'exp_cache_cadence': 1, 'exp_load_from_checkpoint': False, 'exp_print_every_nth_forward': False, 'exp_eval_every_n': 5, 'exp_eval_every_epoch_or_steps': 'epochs', 'exp_eval_test_at_end_only': False, 'exp_artificial_missing': 0, 'exp_optimizer': 'lookahead_lamb', 'exp_lookahead_update_cadence': 6, 'exp_optimizer_warmup_proportion': 0.7, 'exp_optimizer_warmup_fixed_n_steps': 10000, 'exp_lr': 0.001, 'exp_scheduler': 'flat_and_anneal', 'exp_gradient_clipping': 1.0, 'exp_weight_decay': 0, 'exp_tradeoff': 0.5, 'exp_tradeoff_annealing': 'cosine', 'exp_tradeoff_annealing_proportion': 1, 'mp_distributed': False, 'mp_nodes': 1, 'mp_gpus': 1, 'mp_nr': 0, 'mp_no_sync': -1, 'mp_bucket_cap_mb': 25, 'verbose': False, 'debug_leakage': False, 'debug_label_leakage': False, 'debug_row_interactions': False, 'debug_eval_row_interactions': False, 'debug_eval_row_interactions_timer': None, 'debug_row_interactions_mode': None, 'debug_no_stratify': False, 'debug_corrupt_standard_dataset_ablate_shuffle': False, 'model_class': 'NPT', 'sklearn_hyper_search': 'Grid', 'sklearn_model': 'All', 'sklearn_verbose': 1, 'sklearn_n_jobs': -1, 'sklearn_val_final_fit': False, 'model_is_semi_supervised': True, 'model_dtype': 'float32', 'model_amp': False, 'model_feature_type_embedding': True, 'model_feature_index_embedding': True, 'model_bert_augmentation': True, 'model_bert_mask_percentage': 0.9, 'model_augmentation_bert_mask_prob': {'train': 0.15, 'val': 0.0, 'test': 0.0}, 'model_label_bert_mask_prob': {'train': 1, 'val': 1, 'test': 1}, 'model_embedding_layer_norm': False, 'model_att_block_layer_norm': True, 'model_layer_norm_eps': 1e-12, 'model_att_score_norm': 'softmax', 'model_pre_layer_norm': True, 'model_hidden_dropout_prob': 0.1, 'model_att_score_dropout_prob': 0.1, 'model_hybrid_debug': False, 'model_checkpoint_key': None, 'model_dim_hidden': 128, 'model_num_heads': 8, 'model_sep_res_embed': True, 'model_stacking_depth': 8, 'model_mix_heads': True, 'model_rff_depth': 1, 'model_image_n_patches': False, 'model_image_patch_type': 'linear', 'model_image_n_channels': 3, 'model_image_share_embed': True, 'model_image_n_classes': 10, 'model_image_random_crop_and_flip': True, 'metrics_auroc': True, 'viz_att_maps': False, 'viz_att_maps_save_path': 'data/attention_maps', 'cv_index': 0}, 'data_table': array([[0.        , 0.        , 1.        ],
       [0.02454369, 0.        , 1.02454123],
       [0.04908739, 0.        , 1.04906767],
       ...,
       [2.82252465, 0.12121212, 1.31368174],
       [4.17242774, 0.7979798 , 0.14227139],
       [0.29452431, 0.54545455, 1.29028468]]), 'missing_matrix': tensor([[2.6998, 0.1717, 1.4276, 0.0000, 0.0000, 0.0000],
        [4.6142, 0.8687, 0.0048, 0.0000, 0.0000, 0.0000],
        [1.0308, 0.5253, 1.8577, 0.0000, 0.0000, 0.0000],
        ...,
        [2.8225, 0.1212, 1.3137, 0.0000, 0.0000, 0.0000],
        [4.1724, 0.7980, 0.1423, 0.0000, 0.0000, 0.0000],
        [0.2945, 0.5455, 1.2903, 0.0000, 0.0000, 0.0000]], requires_grad=True), 'N': 1256, 'D': 3, 'cat_features': [], 'num_features': [0, 1, 2], 'cat_target_cols': [], 'num_target_cols': [2], 'auroc_setting': False, 'is_data_loaded': True, 'tmp_file_or_dir_names': ['wdbc.data'], 'fixed_split_indices': None, 'boundary_points': array([[False, False, False],
       [False, False, False],
       [False, False, False],
       ...,
       [False, False,  True],
       [False, False,  True],
       [False, False,  True]]), 'collocation_points': tensor([[6.2586, 0.2828, 0.9755, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.7374, 1.0245, 0.0000, 0.0000, 0.0000],
        [6.2586, 0.1010, 0.9755, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.1414, 1.0245, 0.0000, 0.0000, 0.0000],
        [6.2586, 0.3434, 0.9755, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.4242, 1.0245, 0.0000, 0.0000, 0.0000],
        [6.2586, 0.6970, 0.9755, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.0909, 1.0245, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.6667, 1.0245, 0.0000, 0.0000, 0.0000],
        [6.2586, 0.8384, 0.9755, 0.0000, 0.0000, 0.0000],
        [6.2586, 0.8586, 0.9755, 0.0000, 0.0000, 0.0000]], requires_grad=True)}
Loaded metadata for fixed test set. n_cv_splits set to 1.
Fixed test set provided. n_cv_splits set to 1.
{'fixed_test_set_index': 256, 'c': {'entity': None, 'project': 'default', 'wandb_dir': './', 'data_path': 'data', 'data_set': 'ode', 'data_loader_nprocs': 0, 'data_set_on_cuda': False, 'data_force_reload': False, 'data_log_mem_usage': False, 'data_clear_tmp_files': False, 'data_dtype': 'float32', 'exp_device': 'cpu', 'exp_azure_sweep': False, 'exp_test_equivariance': False, 'exp_show_empirical_label_dist': False, 'exp_smoke_test': False, 'exp_name': 'bq4x5wis', 'exp_group': None, 'np_seed': 42, 'torch_seed': 42, 'baseline_seed': 42, 'exp_use_cuda': True, 'exp_n_runs': 1, 'exp_batch_size': -1, 'exp_batch_mode_balancing': True, 'exp_batch_class_balancing': False, 'exp_minibatch_sgd': True, 'exp_val_perc': 0.1, 'exp_test_perc': 0.2, 'exp_num_total_steps': 100000.0, 'exp_patience': -1, 'exp_checkpoint_setting': 'best_model', 'exp_cache_cadence': 1, 'exp_load_from_checkpoint': False, 'exp_print_every_nth_forward': False, 'exp_eval_every_n': 5, 'exp_eval_every_epoch_or_steps': 'epochs', 'exp_eval_test_at_end_only': False, 'exp_artificial_missing': 0, 'exp_optimizer': 'lookahead_lamb', 'exp_lookahead_update_cadence': 6, 'exp_optimizer_warmup_proportion': 0.7, 'exp_optimizer_warmup_fixed_n_steps': 10000, 'exp_lr': 0.001, 'exp_scheduler': 'flat_and_anneal', 'exp_gradient_clipping': 1.0, 'exp_weight_decay': 0, 'exp_tradeoff': 0.5, 'exp_tradeoff_annealing': 'cosine', 'exp_tradeoff_annealing_proportion': 1, 'mp_distributed': False, 'mp_nodes': 1, 'mp_gpus': 1, 'mp_nr': 0, 'mp_no_sync': -1, 'mp_bucket_cap_mb': 25, 'verbose': False, 'debug_leakage': False, 'debug_label_leakage': False, 'debug_row_interactions': False, 'debug_eval_row_interactions': False, 'debug_eval_row_interactions_timer': None, 'debug_row_interactions_mode': None, 'debug_no_stratify': False, 'debug_corrupt_standard_dataset_ablate_shuffle': False, 'model_class': 'NPT', 'sklearn_hyper_search': 'Grid', 'sklearn_model': 'All', 'sklearn_verbose': 1, 'sklearn_n_jobs': -1, 'sklearn_val_final_fit': False, 'model_is_semi_supervised': True, 'model_dtype': 'float32', 'model_amp': False, 'model_feature_type_embedding': True, 'model_feature_index_embedding': True, 'model_bert_augmentation': True, 'model_bert_mask_percentage': 0.9, 'model_augmentation_bert_mask_prob': {'train': 0.15, 'val': 0.0, 'test': 0.0}, 'model_label_bert_mask_prob': {'train': 1, 'val': 1, 'test': 1}, 'model_embedding_layer_norm': False, 'model_att_block_layer_norm': True, 'model_layer_norm_eps': 1e-12, 'model_att_score_norm': 'softmax', 'model_pre_layer_norm': True, 'model_hidden_dropout_prob': 0.1, 'model_att_score_dropout_prob': 0.1, 'model_hybrid_debug': False, 'model_checkpoint_key': None, 'model_dim_hidden': 128, 'model_num_heads': 8, 'model_sep_res_embed': True, 'model_stacking_depth': 8, 'model_mix_heads': True, 'model_rff_depth': 1, 'model_image_n_patches': False, 'model_image_patch_type': 'linear', 'model_image_n_channels': 3, 'model_image_share_embed': True, 'model_image_n_classes': 10, 'model_image_random_crop_and_flip': True, 'metrics_auroc': True, 'viz_att_maps': False, 'viz_att_maps_save_path': 'data/attention_maps', 'cv_index': 0}, 'data_table': array([[0.        , 0.        , 1.        ],
       [0.02454369, 0.        , 1.02454123],
       [0.04908739, 0.        , 1.04906767],
       ...,
       [2.82252465, 0.12121212, 1.31368174],
       [4.17242774, 0.7979798 , 0.14227139],
       [0.29452431, 0.54545455, 1.29028468]]), 'missing_matrix': tensor([[2.6998, 0.1717, 1.4276, 0.0000, 0.0000, 0.0000],
        [4.6142, 0.8687, 0.0048, 0.0000, 0.0000, 0.0000],
        [1.0308, 0.5253, 1.8577, 0.0000, 0.0000, 0.0000],
        ...,
        [2.8225, 0.1212, 1.3137, 0.0000, 0.0000, 0.0000],
        [4.1724, 0.7980, 0.1423, 0.0000, 0.0000, 0.0000],
        [0.2945, 0.5455, 1.2903, 0.0000, 0.0000, 0.0000]], requires_grad=True), 'N': 1256, 'D': 3, 'cat_features': [], 'num_features': [0, 1, 2], 'cat_target_cols': [], 'num_target_cols': [2], 'auroc_setting': False, 'is_data_loaded': True, 'tmp_file_or_dir_names': ['wdbc.data'], 'fixed_split_indices': None, 'boundary_points': array([[False, False, False],
       [False, False, False],
       [False, False, False],
       ...,
       [False, False,  True],
       [False, False,  True],
       [False, False,  True]]), 'collocation_points': tensor([[6.2586, 0.2828, 0.9755, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.7374, 1.0245, 0.0000, 0.0000, 0.0000],
        [6.2586, 0.1010, 0.9755, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.1414, 1.0245, 0.0000, 0.0000, 0.0000],
        [6.2586, 0.3434, 0.9755, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.4242, 1.0245, 0.0000, 0.0000, 0.0000],
        [6.2586, 0.6970, 0.9755, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.0909, 1.0245, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.6667, 1.0245, 0.0000, 0.0000, 0.0000],
        [6.2586, 0.8384, 0.9755, 0.0000, 0.0000, 0.0000],
        [6.2586, 0.8586, 0.9755, 0.0000, 0.0000, 0.0000]], requires_grad=True)}
Percentage of each group: Train 0.18 | Val 0.03 | Test 0.80
train val test split:  [   0  224  256 1256]
len missing matrix 989
data dict {'fixed_test_set_index': 256, 'c': {'entity': None, 'project': 'default', 'wandb_dir': './', 'data_path': 'data', 'data_set': 'ode', 'data_loader_nprocs': 0, 'data_set_on_cuda': False, 'data_force_reload': False, 'data_log_mem_usage': False, 'data_clear_tmp_files': False, 'data_dtype': 'float32', 'exp_device': 'cpu', 'exp_azure_sweep': False, 'exp_test_equivariance': False, 'exp_show_empirical_label_dist': False, 'exp_smoke_test': False, 'exp_name': 'bq4x5wis', 'exp_group': None, 'np_seed': 42, 'torch_seed': 42, 'baseline_seed': 42, 'exp_use_cuda': True, 'exp_n_runs': 1, 'exp_batch_size': -1, 'exp_batch_mode_balancing': True, 'exp_batch_class_balancing': False, 'exp_minibatch_sgd': True, 'exp_val_perc': 0.1, 'exp_test_perc': 0.2, 'exp_num_total_steps': 100000.0, 'exp_patience': -1, 'exp_checkpoint_setting': 'best_model', 'exp_cache_cadence': 1, 'exp_load_from_checkpoint': False, 'exp_print_every_nth_forward': False, 'exp_eval_every_n': 5, 'exp_eval_every_epoch_or_steps': 'epochs', 'exp_eval_test_at_end_only': False, 'exp_artificial_missing': 0, 'exp_optimizer': 'lookahead_lamb', 'exp_lookahead_update_cadence': 6, 'exp_optimizer_warmup_proportion': 0.7, 'exp_optimizer_warmup_fixed_n_steps': 10000, 'exp_lr': 0.001, 'exp_scheduler': 'flat_and_anneal', 'exp_gradient_clipping': 1.0, 'exp_weight_decay': 0, 'exp_tradeoff': 0.5, 'exp_tradeoff_annealing': 'cosine', 'exp_tradeoff_annealing_proportion': 1, 'mp_distributed': False, 'mp_nodes': 1, 'mp_gpus': 1, 'mp_nr': 0, 'mp_no_sync': -1, 'mp_bucket_cap_mb': 25, 'verbose': False, 'debug_leakage': False, 'debug_label_leakage': False, 'debug_row_interactions': False, 'debug_eval_row_interactions': False, 'debug_eval_row_interactions_timer': None, 'debug_row_interactions_mode': None, 'debug_no_stratify': False, 'debug_corrupt_standard_dataset_ablate_shuffle': False, 'model_class': 'NPT', 'sklearn_hyper_search': 'Grid', 'sklearn_model': 'All', 'sklearn_verbose': 1, 'sklearn_n_jobs': -1, 'sklearn_val_final_fit': False, 'model_is_semi_supervised': True, 'model_dtype': 'float32', 'model_amp': False, 'model_feature_type_embedding': True, 'model_feature_index_embedding': True, 'model_bert_augmentation': True, 'model_bert_mask_percentage': 0.9, 'model_augmentation_bert_mask_prob': {'train': 0.15, 'val': 0.0, 'test': 0.0}, 'model_label_bert_mask_prob': {'train': 1, 'val': 1, 'test': 1}, 'model_embedding_layer_norm': False, 'model_att_block_layer_norm': True, 'model_layer_norm_eps': 1e-12, 'model_att_score_norm': 'softmax', 'model_pre_layer_norm': True, 'model_hidden_dropout_prob': 0.1, 'model_att_score_dropout_prob': 0.1, 'model_hybrid_debug': False, 'model_checkpoint_key': None, 'model_dim_hidden': 128, 'model_num_heads': 8, 'model_sep_res_embed': True, 'model_stacking_depth': 8, 'model_mix_heads': True, 'model_rff_depth': 1, 'model_image_n_patches': False, 'model_image_patch_type': 'linear', 'model_image_n_channels': 3, 'model_image_share_embed': True, 'model_image_n_classes': 10, 'model_image_random_crop_and_flip': True, 'metrics_auroc': True, 'viz_att_maps': False, 'viz_att_maps_save_path': 'data/attention_maps', 'cv_index': 0}, 'data_table': array([[0.        , 0.        , 1.        ],
       [0.02454369, 0.        , 1.02454123],
       [0.04908739, 0.        , 1.04906767],
       ...,
       [2.82252465, 0.12121212, 1.31368174],
       [4.17242774, 0.7979798 , 0.14227139],
       [0.29452431, 0.54545455, 1.29028468]]), 'missing_matrix': tensor([[2.6998, 0.1717, 1.4276, 0.0000, 0.0000, 0.0000],
        [4.6142, 0.8687, 0.0048, 0.0000, 0.0000, 0.0000],
        [1.0308, 0.5253, 1.8577, 0.0000, 0.0000, 0.0000],
        ...,
        [2.8225, 0.1212, 1.3137, 0.0000, 0.0000, 0.0000],
        [4.1724, 0.7980, 0.1423, 0.0000, 0.0000, 0.0000],
        [0.2945, 0.5455, 1.2903, 0.0000, 0.0000, 0.0000]], requires_grad=True), 'N': 1256, 'D': 3, 'cat_features': [], 'num_features': [0, 1, 2], 'cat_target_cols': [], 'num_target_cols': [2], 'auroc_setting': False, 'is_data_loaded': True, 'tmp_file_or_dir_names': ['wdbc.data'], 'fixed_split_indices': None, 'boundary_points': array([[False, False, False],
       [False, False, False],
       [False, False, False],
       ...,
       [False, False,  True],
       [False, False,  True],
       [False, False,  True]]), 'collocation_points': tensor([[6.2586, 0.2828, 0.9755, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.7374, 1.0245, 0.0000, 0.0000, 0.0000],
        [6.2586, 0.1010, 0.9755, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.1414, 1.0245, 0.0000, 0.0000, 0.0000],
        [6.2586, 0.3434, 0.9755, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.4242, 1.0245, 0.0000, 0.0000, 0.0000],
        [6.2586, 0.6970, 0.9755, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.0909, 1.0245, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.6667, 1.0245, 0.0000, 0.0000, 0.0000],
        [6.2586, 0.8384, 0.9755, 0.0000, 0.0000, 0.0000],
        [6.2586, 0.8586, 0.9755, 0.0000, 0.0000, 0.0000]], requires_grad=True)}
Traceback (most recent call last):
  File "run.py", line 204, in <module>
    main(args)
  File "run.py", line 23, in main
    run_cv(args=args, wandb_args=wandb_args)
  File "run.py", line 117, in run_cv
    run_cv_splits(wandb_args, args, c, wandb_run)
  File "run.py", line 125, in run_cv_splits
    dataset = ColumnEncodingDataset(c)
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/column_encoding_dataset.py", line 102, in __init__
    self.reset_cv_splits()
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/column_encoding_dataset.py", line 107, in reset_cv_splits
    self.dataset_gen = self.run_preprocessing_and_caching()
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/column_encoding_dataset.py", line 405, in run_preprocessing_and_caching
    for split_idx, data_dict in enumerate(self.dataset_gen):
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/column_encoding_dataset.py", line 542, in generate_classification_regression_dataset
    new_missing_matrix = missing_matrix[
IndexError: index 989 is out of bounds for dimension 0 with size 989
Traceback (most recent call last):
  File "run.py", line 204, in <module>
    main(args)
  File "run.py", line 23, in main
    run_cv(args=args, wandb_args=wandb_args)
  File "run.py", line 117, in run_cv
    run_cv_splits(wandb_args, args, c, wandb_run)
  File "run.py", line 125, in run_cv_splits
    dataset = ColumnEncodingDataset(c)
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/column_encoding_dataset.py", line 102, in __init__
    self.reset_cv_splits()
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/column_encoding_dataset.py", line 107, in reset_cv_splits
    self.dataset_gen = self.run_preprocessing_and_caching()
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/column_encoding_dataset.py", line 405, in run_preprocessing_and_caching
    for split_idx, data_dict in enumerate(self.dataset_gen):
  File "/Users/devu/PycharmProjects/non-parametric-transformers/npt/column_encoding_dataset.py", line 542, in generate_classification_regression_dataset
    new_missing_matrix = missing_matrix[
IndexError: index 989 is out of bounds for dimension 0 with size 989